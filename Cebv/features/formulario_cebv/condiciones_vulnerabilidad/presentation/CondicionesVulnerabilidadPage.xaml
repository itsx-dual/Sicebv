<Page x:Class="Cebv.features.formulario_cebv.condiciones_vulnerabilidad.presentation.CondicionesVulnerabilidadPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:Cebv.features.formulario_cebv.condiciones_vulnerabilidad.presentation"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
      ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      d:DesignWidth="1000"
      d:DesignHeight="1000"
      mc:Ignorable="d"
      Name="PageCondiciones"
      Title="CondicionesVulnerabilidadPage">
    <Page.DataContext>
        <local:CondicionesVulnerabilidadViewModel />
    </Page.DataContext>
    
    <StackPanel Margin="5">
        <StackPanel MinWidth="200"
                    HorizontalAlignment="Left">
            <ui:TextBlock Text="Tipo de sangre"
                          FontTypography="Caption" />
            <ComboBox />
        </StackPanel>

        <ui:TextBlock Text="Condiciones de salud"
                      FontTypography="Subtitle" />

        <ui:DataGrid MinHeight="300"
                     AutoGenerateColumns="False"
                     ItemsSource="{Binding CondicionesSalud}">
            <ui:DataGrid.Columns>
                <DataGridTextColumn Header="Condición"
                                    Width="*"
                                    Binding="{Binding Path=condicion }" />
                <DataGridTextColumn Header="Tratamiento"
                                    Width="*"
                                    Binding="{Binding Path=tratamiento}" />
                <DataGridTextColumn Header="Naturaleza"
                                    Width="*"
                                    Binding="{Binding Path=naturaleza}" />
            </ui:DataGrid.Columns>
        </ui:DataGrid>
        
        <ui:TextBlock Text="Enfoque diferenciado"
                      FontTypography="Subtitle" />
        <Border Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                Margin="5"
                CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                
                <StackPanel Grid.ColumnSpan="3" 
                            MinWidth="200">
                    <ui:TextBlock Text="Pertenencia grupal o étnica"
                                  FontTypography="Caption" />
                    <ComboBox />
                </StackPanel>
                
                <StackPanel Grid.Column="0"
                            Grid.Row="1"
                            MinWidth="200"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Bottom">
                    <ui:TextBlock Text="Enfoque diferenciado"
                                  FontTypography="Caption" />
                    <StackPanel Orientation="Horizontal">
                        <ComboBox MinWidth="200"
                                  ItemsSource="{Binding EnfoquesDiferenciadosCatalogo}"
                                  SelectedItem="{Binding EnfoqueDiferenciado}"/>
                        <ui:Button Icon="{ui:SymbolIcon Add24}"
                                   VerticalAlignment="Stretch"
                                   Appearance="Primary"
                                   Command="{Binding AddEnfoqueDiferenciadoCommand}"/>
                        
                    </StackPanel>
                    <ui:ListView ItemsSource="{Binding Path=EnfoquesDiferenciadosSeleccionados}"
                                 SelectedIndex="{Binding EnfoqueDiferenciadoIndex}"
                                 Name="EnfoqueDirenciadoListView">
                        <ui:ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="3"
                                      VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <ui:TextBlock Grid.Column="0"
                                                  Text="{Binding Chars}"
                                                  VerticalAlignment="Center"/>
                                    
                                    <StackPanel Grid.Column="1"
                                                HorizontalAlignment="Right">
                                        <!-- Si no se realiza el binding al RelayCommand de esta manera,-->
                                        <!-- se realiza otra instancia aparte del viewmodel donde el index siempre es 0 -->
                                        <ui:Button Appearance="Danger"
                                                   Icon="{ui:SymbolIcon Delete24}"
                                                   Command="{Binding ElementName=PageCondiciones, Path=DataContext.RemoveEnfoqueDiferenciadoCommand}"
                                                   CommandParameter="{Binding Chars}"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ui:ListView.ItemTemplate>
                    </ui:ListView>
                </StackPanel>
                
                <StackPanel Grid.Column="1"
                            Grid.Row="1"
                            MinWidth="200"
                            HorizontalAlignment="Left">
                    <ui:TextBlock Text="Caracteristicas que pueden poner a la persona en mayor vulnerabilidad"
                                  FontTypography="Caption"  TextWrapping="Wrap"/>
                    <StackPanel Orientation="Horizontal">
                        <ComboBox MinWidth="200"
                                  ItemsSource="{Binding EnfoquesDiferenciadosCatalogo}"
                                  SelectedItem="{Binding EnfoqueDiferenciado}"/>
                        
                        <ui:Button Icon="{ui:SymbolIcon Add24}"
                                   Appearance="Primary"
                                   VerticalAlignment="Stretch"
                                   Command="{Binding AddEnfoqueDiferenciadoCommand}"/>
                        
                    </StackPanel>
                    <ui:ListView ItemsSource="{Binding Path=EnfoquesDiferenciadosSeleccionados}"
                                 SelectedIndex="{Binding EnfoqueDiferenciadoIndex}"
                                 Name="CaracteristicaPersonalListView">
                        <ui:ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="3"
                                      VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <ui:TextBlock Grid.Column="0"
                                                  Text="{Binding Chars}"
                                                  VerticalAlignment="Center"/>
                                    
                                    <StackPanel Grid.Column="1"
                                                HorizontalAlignment="Right">
                                        <!-- Si no se realiza el binding al RelayCommand de esta manera,-->
                                        <!-- se realiza otra instancia aparte del viewmodel donde el index siempre es 0 -->
                                        <ui:Button Appearance="Danger"
                                                   Icon="{ui:SymbolIcon Delete24}"
                                                   Command="{Binding ElementName=PageCondiciones, Path=DataContext.RemoveEnfoqueDiferenciadoCommand}"
                                                   CommandParameter="{Binding Chars}"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ui:ListView.ItemTemplate>
                    </ui:ListView>
                </StackPanel>
                
            </Grid>
            
        </Border>

        <ui:TextBlock Text="Embarazo"
                      FontTypography="Subtitle" />

        <Border Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                Margin="5"
                CornerRadius="8">
            <WrapPanel>
                <ui:ToggleSwitch Content="¿Esta embarazada?"
                                 Name="EmbarazoToggleSwitch" />
                
                <StackPanel MinWidth="200"
                            HorizontalAlignment="Left">
                    <ui:TextBlock Text="Meses de embarazo"
                                  FontTypography="Caption" />
                    <ui:NumberBox Maximum="9"
                                  Minimum="0"
                                  IsEnabled="{Binding ElementName=EmbarazoToggleSwitch, Path=IsChecked}" />
                </StackPanel>
            </WrapPanel>
        </Border>

        <ui:Button Content="Guardar y siguente"
                   Icon="{ui:SymbolIcon Save24}"
                   HorizontalAlignment="Stretch"
                   Appearance="Primary" />
    </StackPanel>
</Page>